
$(document).ready(function($)
{
    $('body').on('mouseenter', '.datatablefilter', function()
    {
        $(this).find('.filterfunctions').removeClass('uk-hidden');
    });

    $('body').on('mouseleave', '.datatablefilter', function()
    {
        $(this).find('.filterfunctions').addClass('uk-hidden');
    });

    $('body').on('click', '.filterfunctions .close', function(e)
    {
        e.stopPropagation();

        $(this).closest('.datatablefilter').find('input, select, textarea').each(function()
        {
            $(this).val('');
            $(this).change();
        });
    });

    $('th input').click(function(e)
    {
        e.stopPropagation();
    });

    $('input[type="date"]').change(function()
    {
        $(this).data('timestamp', new Date($(this).val()).getTime() / 1000);
    });
    
    window.normalFilter = function (container, section)
    {
        window._filter(container, section, true);
    }

    window.rangeFilter = function (container, section)
    {
        window._filter(container, section);
    }

    window._filter = function (container, section, searchValue = false)
    {
        $('input', section).on('keyup change click clear', function ()
        {
            let value = $(this).val().toLowerCase();

            if($(this).attr('type') == 'date')
                value = new Date(value).getTime() / 1000;

            $(this).data('value', value);

            // if(container.search() !== value)
            // {
                if(searchValue)
                    container.search(this.value, true, false).draw();

                else
                    container.draw();
            // }
        });        
    }

});